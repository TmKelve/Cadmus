
#Importando as bibliotecas 
import pandas as pd
import requests
import win32com.client as win32
from datetime import date
from bs4 import BeautifulSoup

#Fazendo Requests para verificar o site
req = requests.get('https://cadmus.com.br/vagas-tecnologia/')
if req.status_code == 200:
    print('Requisição bem sucedida!')
    content = req.content


#Importando os Requests
import requests


#Tranformando conteudo da pagina em String

html_vagas = """<div id="pfolio" class="row d-flex justify-content-center animate slideInUp 1s animated null" style="position: relative; height: 1879.17px;"><div class="item col-md-3 text-center mt-4 portfolio-item Backend" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 0px; top: 0px;"><div class="box"><h3>Analista de Sistemas Sênior </h3><p class="local"><i class="fas fa-map-marker-alt"></i> Morumbi - SP </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('0');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Infra" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 225px; top: 0px;"><div class="box"><h3>Analista de Infraestrutura Bilingue</h3><p class="local"><i class="fas fa-map-marker-alt"></i> Alphaville - SP </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('1');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Frontend" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 450px; top: 0px;"><div class="box"><h3>Analista de Teste </h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('2');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Agile" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 675px; top: 0px;"><div class="box"><h3>Analista Jurídico Pl II</h3><p class="local"><i class="fas fa-map-marker-alt"></i> Alphaville - SP </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('3');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Agile" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 0px; top: 208px;"><div class="box"><h3>Analista BI</h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office  </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('4');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Agile" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 225px; top: 208px;"><div class="box"><h3>Scrum Master</h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('5');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Fullstack" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 450px; top: 208px;"><div class="box"><h3>Tech Lead - Mobile </h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home office </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('6');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Agile" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 675px; top: 208px;"><div class="box"><h3>Agile Master </h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('7');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Fullstack" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 0px; top: 417px;"><div class="box"><h3>Desenvolvedor Mobile - Flutter </h3><p class="local"><i class="fas fa-map-marker-alt"></i> home office </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('8');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Backend" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 225px; top: 417px;"><div class="box"><h3>Engenheiro de Software Java Especialista</h3><p class="local"><i class="fas fa-map-marker-alt"></i> São Paulo </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('9');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Fullstack" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 450px; top: 417px;"><div class="box"><h3>Desenvolvedor Móbile Sênior</h3><p class="local"><i class="fas fa-map-marker-alt"></i> São Paulo </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('10');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Backend" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 675px; top: 417px;"><div class="box"><h3>Desenvolvedor Backend Sr</h3><p class="local"><i class="fas fa-map-marker-alt"></i> São Paulo </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('11');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Fullstack" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 0px; top: 626px;"><div class="box"><h3>Engenheiro de Software Sr (.NET Core e/ou Node.js)</h3><p class="local"><i class="fas fa-map-marker-alt"></i> São Paulo </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('12');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Backend" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 225px; top: 626px;"><div class="box"><h3>Analista SOA.</h3><p class="local"><i class="fas fa-map-marker-alt"></i> São Paulo </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('13');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Frontend" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 450px; top: 626px;"><div class="box"><h3>UX/UI Designer Pleno</h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('14');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Backend" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 675px; top: 626px;"><div class="box"><h3> Desenvolvedor Back End NodeJS </h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home office </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('15');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Agile" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 0px; top: 835px;"><div class="box"><h3>Scrum Master</h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('16');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Agile" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 225px; top: 835px;"><div class="box"><h3>Scrum Master </h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office  </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('17');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Backend" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 450px; top: 835px;"><div class="box"><h3>Desenvolvedor .NET </h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office  </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('18');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Backend" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 675px; top: 835px;"><div class="box"><h3>Desenvolvedor .NET/Oracle</h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('19');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Agile" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 0px; top: 1043px;"><div class="box"><h3>Tech Lead </h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office  </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('20');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Agile" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 225px; top: 1043px;"><div class="box"><h3>QA com conhecimento em Jest</h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office  </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('21');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Backend" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 450px; top: 1043px;"><div class="box"><h3>Desenvolvedor RPA </h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office  </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('22');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Fullstack" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 675px; top: 1043px;"><div class="box"><h3>Desenvolvedor Full Stack </h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office  </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('23');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Frontend" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 0px; top: 1252px;"><div class="box"><h3>Desenvolvedor FontEnd React</h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office  </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('24');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Backend" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 225px; top: 1252px;"><div class="box"><h3>Desenvolvedor Back End Java </h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office  </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('25');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Backend" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 450px; top: 1252px;"><div class="box"><h3>Analista de Processos RPA </h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office  </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('26');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Backend" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 675px; top: 1252px;"><div class="box"><h3>Analista de NOC Jr III</h3><p class="local"><i class="fas fa-map-marker-alt"></i> São Paulo </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('27');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Backend" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 0px; top: 1461px;"><div class="box"><h3>Dev Peoplesoft - ERP</h3><p class="local"><i class="fas fa-map-marker-alt"></i> São Paulo </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('28');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Infra" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 225px; top: 1461px;"><div class="box"><h3>Estágio Logistica </h3><p class="local"><i class="fas fa-map-marker-alt"></i> São Judas - SP  </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('29');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Infra" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 450px; top: 1461px;"><div class="box"><h3>Estágio em TI </h3><p class="local"><i class="fas fa-map-marker-alt"></i> São Judas - SP  </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('30');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Agile" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 675px; top: 1461px;"><div class="box"><h3>Especialista em QA</h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('31');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Agile" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 0px; top: 1670px;"><div class="box"><h3>Lider Técnico </h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office  </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('32');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Infra" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 225px; top: 1670px;"><div class="box"><h3>Analista Service Desk Jr I </h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('33');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Backend" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 450px; top: 1670px;"><div class="box"><h3>Desenvolvedor BackEnd Java - Springboot </h3><p class="local"><i class="fas fa-map-marker-alt"></i> Home Office  </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('34');">Ver detalhes da vaga</a></p></div></div><div class="item col-md-3 text-center mt-4 portfolio-item Fullstack" data-animation="slideInUp" data-delay="1s" style="position: absolute; left: 675px; top: 1670px;"><div class="box"><h3>Desenvolvedor FullStack</h3><p class="local"><i class="fas fa-map-marker-alt"></i> São Paulo </p><p class="link-vagas m-0"><a class="btn azul" href="vem-ser-cadmus" onclick="javascript:AbrirOportunidade('35');">Ver detalhes da vaga</a></p></div></div></div>"""


#Parser HTML
soup = BeautifulSoup(html_vagas,'html.parser')


#Raspagem de Pagina e criação da lista
vagas = soup.find_all("h3")
cidades = soup.find_all("p", attrs={"class": "local"})
ListVagas = []
for vaga, cidade in zip(vagas, cidades):
    ListVagas.append((vaga.text, cidade.text))

print(ListVagas)


#Criação do DataFrame no Pandas / Convertendo para HTML
Vagas_df = pd.DataFrame(ListVagas, columns=['Vaga','Local'])


#Criação do arquivo xlsx / html
VagasHTML = Vagas_df.to_html()
Vagas_df.to_excel('RelatorioDeVagas.xlsx',index=False)


#Dados para o Relatório
data_atual = date.today()
Data = '{}/{}/{}'.format(data_atual.day, data_atual.month,data_atual.year)
Qtn_Vagas = len(ListVagas)



#Configurações  do Email
outlook = win32.Dispatch('outlook.application')
email = outlook.CreateItem(0)
email.To = "tomkelve2019@gmail.com"
email.subject = "Relatorio de Vagas - Cadmus"
Relatorio = "D:/Cadmus/RelatorioDeVagas.xlsx"
email.Attachments.Add(Relatorio)



#Corpo do Email
email.HTMLBody = f"""
<p>Olá, tudo bem?</p>
<p>Esse é um relatorio datado {Data},o qual nos informa que, a Cadmus possuí {Qtn_Vagas} setores com vagas em aberto. </p>
{VagasHTML}

<p>Desde já, agradeço pela atenção!</p>
<p>Um abraço,</p> 
<p>Automação Python</p>
"""
email.Send()
print("Email Enviado")




# %%
